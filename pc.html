<html>
<head>

  <title>Public Client Flow</title>
  <script src='https://code.jquery.com/jquery-1.11.2.min.js'></script>
  <!-- Include the CJS SDK -->
  <script src="https://sdk-cdn.mypurecloud.com/javascript/64.0.0/purecloud-platform-client-v2.min.js"></script>

  <script type="text/javascript">
    // Obtain a reference to the platformClient object
    const platformClient = require('platformClient');
    
    const client = platformClient.ApiClient.instance;
    const clientId = "111d49da-28b1-43f0-af26-c03f42e80463";
    const redirectUri = "https://aferfra.github.io/purecloud.html";
    
    const usersApi = new platformClient.UsersApi();
    
    client.setEnvironment(platformClient.PureCloudRegionHosts.eu_west_1);
    client.setReturnExtendedResponses(true);
    client.setPersistSettings(true);
    
    // Authenticate
    client.loginImplicitGrant(clientId, redirectUri)
    
    .then((data) => {
        console.log(data);
        // Do authenticated things
          return usersApi.getUsersMe({ 'expand': ["presence"] });
          
          .then((userMe) => {
            // Handle successful result
            console.log(`Hello, ${userMe.name}!`);
          })
          
          .catch((err) => {
            // Handle failure response
            console.log(err);
          });
      })
    
    .catch((err) => {
        // Handle failure response
        console.log(err);
      });
  </script>
  
</head>

<body>

  <p id="stationName"></p>
  <p id="stationId"></p>

  <form method="post">
  <button id="clear" value="clear_station" name="name_clear_station">CLEAR</button>
  </form>
  
</body>	
</html>
