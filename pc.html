<html>
<head>

  <title>Another Clap</title>
  <script src='https://code.jquery.com/jquery-1.11.2.min.js'></script>
  <!-- Include the CJS SDK -->
  <script src="https://sdk-cdn.mypurecloud.com/javascript/64.0.0/purecloud-platform-client-v2.min.js"></script>

  <script type="text/javascript">
    
    console.log("#### Versionado v1.5 ######### Realizamos JSON !!!!");
    
    // Obtain a reference to the platformClient object
    const platformClient = require('platformClient');
    
    const client = platformClient.ApiClient.instance;
    const clientId = "111d49da-28b1-43f0-af26-c03f42e80463";
    const redirectUri = "https://aferfra.github.io/pc.html";
    
    //const usersApi = new platformClient.UsersApi();
    const stationsApi = new platformClient.StationsApi();

    
    client.setEnvironment(platformClient.PureCloudRegionHosts.eu_west_1);
    client.setReturnExtendedResponses(true);
    client.setPersistSettings(true);
    client.setDebugLog(console.log, 50);
    
    // Authenticate
    client.loginImplicitGrant(clientId, redirectUri)    
      .then((data) => {
        console.log("## Estamos dentro ##")
        //console.log(data);
        // Do authenticated things
        //return usersApi.getUsersMe({ 'expand': ["presence"] });
      
      //Parametros de StationsApi
      let opts = { 
        'pageSize': 25, // Number | Page size
        'pageNumber': 1, // Number | Page number
        'sortBy': "name", // String | Sort by
        'name': "", // String | Name
        'userSelectable': "", // String | True for stations that the user can select otherwise false
        'webRtcUserId': "", // String | Filter for the webRtc station of the webRtcUserId
        'id': "", // String | Comma separated list of stationIds
        'lineAppearanceId': "" // String | lineAppearanceId
      };
      
        stationsApi.getStations(opts)
        .then((data) => {
          console.log(`getStations success! data: ${JSON.stringify(data, null, 2)}`);
          
          document.getElementById("stationName").innerHTML = Body.entities[0].name;
		      document.getElementById("stationId").innerHTML = Body.entities[0].id;
          
        })
        .catch((err) => {
          console.log('There was a failure calling getStations');
          console.error(err);
        });
      
      })    
      /*.then((userMe) => {
        // Handle successful result
        console.log(`Hello, ${userMe.name}!`);
      })*/    
      .catch((err) => {
        // Handle failure response
        console.log(err);
      });
    
    
    
  </script>
  
</head>

<body>

  <p id="stationName"></p>
  <p id="stationId"></p>

  <form method="post">
  <button id="clear" value="clear_station" name="name_clear_station">CLEAR</button>
  </form>
  
</body>	
</html>
